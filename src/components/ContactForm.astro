---
// Definimos las propiedades con valores por defecto
const { serviceName = "Servicio", formId = "mgolzeyp" } = Astro.props; 
---

<form action={`https://formspree.io/f/${formId}`} method="POST" id="my-form" class="contact-form">
  <input type="hidden" name="_subject" value={`Nueva consulta: ${serviceName}`} />
  
  <button type="submit" id="submit-button" class="btn-submit">Solicitar Información</button>
  <p id="form-status"></p>
</form>

<script is:inline>
  const form = document.getElementById("my-form");
  const status = document.getElementById("form-status");
  const button = document.getElementById("submit-button");

  form.addEventListener("submit", async (event) => {
    event.preventDefault(); // Evita que se abra la página de Formspree
    
    button.disabled = true;
    button.innerText = "Enviando...";
    
    const data = new FormData(event.target);
    
    try {
      const response = await fetch(event.target.action, {
        method: form.method,
        body: data,
        headers: {
          'Accept': 'application/json'
        }
      });

      if (response.ok) {
        // ¡ÉXITO! Aquí es donde ocurre la magia gratis
        window.location.href = "/gracias"; 
      } else {
        const errorData = await response.json();
        status.innerHTML = "Error: " + errorData.errors.map(error => error.message).join(", ");
        button.disabled = false;
        button.innerText = "Solicitar Información";
      }
    } catch (error) {
      status.innerHTML = "Ups! Hubo un problema al enviar el formulario.";
      button.disabled = false;
      button.innerText = "Solicitar Información";
    }
  });
</script>

<style>
  .contact-form { 
    background: #f9f9f9; 
    padding: 30px; 
    border-radius: 12px; 
    border: 1px solid #eee; 
    box-shadow: 0 4px 6px rgba(0,0,0,0.05);
  }
  .form-group { margin-bottom: 20px; text-align: left; }
  .form-group label { display: block; margin-bottom: 8px; font-weight: bold; color: #333; }
  
  /* Actualizado para incluir el select */
  .form-group input, 
  .form-group textarea,
  .form-group select { 
    width: 100%; 
    padding: 12px; 
    border: 1px solid #ccc; 
    border-radius: 6px; 
    font-family: inherit; 
    box-sizing: border-box;
    background-color: white;
  }
  
  .btn-submit { 
    background: #00a69c; 
    color: white; 
    border: none; 
    padding: 15px 25px; 
    border-radius: 8px; 
    font-weight: bold; 
    cursor: pointer; 
    width: 100%; 
    transition: background 0.3s; 
  }
  .btn-submit:hover { background: #008f86; }
</style>